import{_ as j}from"./AuthenticatedLayout-CD8uY5zI.js";import{j as i,o as s,b as e,m as $,g as B,p as I,a as q,n as k,d as z,w as H,i as G,F as M,q as A,s as K,k as J,t as l,c as T,x as E,y as Q,T as U,z as V,A as X,f as R,B as ee}from"./app-VKdpvpg5.js";import{d as b}from"./dayjs.min-RKMcYrVi.js";import{r as te}from"./BriefcaseIcon-WA8FfMLc.js";import{r as se}from"./CurrencyDollarIcon-D66OxRAX.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";function oe(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"})])}function re(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"})])}const ae={class:"pb-3"},ne={class:"welcome-header"},le={class:"flex items-center justify-between"},ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},de={class:"flex items-center justify-between"},ce={class:"text-sm font-medium text-tertiary-light"},ue={class:"text-2xl font-bold text-tertiary-light mt-1"},me={__name:"StatCards",setup(x){let p=$([]),d=$([]),g=$(0),o=$(0),r=$(0),y=$(!1);const c=()=>{y.value=!y.value},a=B(()=>{const h=b();return p.value.filter(u=>b(u.created_at).isSame(h,"month")).length}),t=B(()=>{const h=d.value.filter(m=>m.status==="completed"&&m.satisfaction_score!=null);if(h.length===0)return 0;const u=h.reduce((m,w)=>m+Number(w.satisfaction_score),0);return Math.round(u/h.length*20)}),v=B(()=>[{title:"Total Customers",value:p.value.length,icon:re,iconBg:"bg-blue-50",iconColor:"text-blue-500",footer:`+${a.value} this month`,footerColor:"text-gray-500"},{title:"Active Jobs",value:g.value,icon:te,iconBg:"bg-purple-50",iconColor:"text-purple-500",footer:`${o.value} overdue jobs`,footerColor:"text-red-500"},{title:"Receivables",value:`₦${r.value.toLocaleString()}`,icon:se,iconBg:"bg-green-50",iconColor:"text-green-500",footer:null},{title:"Customer Satisfaction",value:`${t.value}%`,icon:oe,iconBg:"bg-yellow-50",iconColor:"text-yellow-500",footer:null}]),n=()=>{V.get("/get_customer").then(h=>{p.value=h.data})},f=()=>{V.get("/get_user/jobs").then(h=>{d.value=h.data,g.value=d.value.filter(u=>u.status!=="completed").length,o.value=d.value.filter(u=>u.status!=="completed"&&b(u.due_date).isBefore(b(),"day")).length})},_=()=>{V.get("/get_user/total_receivables").then(h=>{r.value=h.data})};return I(()=>{n(),f(),_()}),(h,u)=>(s(),i("div",ae,[e("div",ne,[e("div",le,[u[1]||(u[1]=e("div",{class:"flex flex-col"},[e("h1",{class:"text-2xl font-bold text-primary-dark"}," Welcome to Your Dashboard "),e("p",{class:"text-gray-500 text-sm mt-1"}," Here's what's happening with your business ")],-1)),e("button",{onClick:c,class:k(["text-gray-500 hover:text-primary transition-all duration-200 p-1 rounded-full hover:bg-gray-100",{"rotate-180":z(y)}]),"aria-label":"Toggle statistics"},u[0]||(u[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)]),2)])]),u[2]||(u[2]=e("hr",{class:"mb-4 border-gray-200"},null,-1)),q(U,{name:"fade-slide","enter-active-class":"transition-all duration-300 ease-out","leave-active-class":"transition-all duration-200 ease-in","enter-from-class":"opacity-0 -translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-4"},{default:H(()=>[G(e("div",ie,[(s(!0),i(M,null,A(v.value,(m,w)=>(s(),i("div",{key:w,class:"bg-primary-dark p-5 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 hover:-translate-y-1",style:K({"transition-delay":`${w*50}ms`})},[e("div",de,[e("div",null,[e("p",ce,l(m.title),1),e("p",ue,l(m.value),1)]),e("div",{class:k(["p-3 rounded-full",m.iconBg])},[(s(),T(E(m.icon),{class:k(["h-6 w-6",m.iconColor])},null,8,["class"]))],2)]),m.footer?(s(),i("p",{key:0,class:k(["text-xs mt-3 bg-white rounded-md px-3 w-fit py-1",m.footerColor])},l(m.footer),3)):J("",!0)],4))),128))],512),[[Q,!z(y)]])]),_:1})]))}},pe={class:"bg-primary-light/10 shadow rounded-lg p-4 mb-8"},ge={class:"hidden md:block"},ve={class:"min-w-full divide-y divide-gray-200"},he={key:0,class:"divide-y divide-gray-200 bg-white"},xe={class:"px-4 py-3 text-sm text-gray-700"},fe={class:"px-4 py-3 text-sm text-gray-700"},_e={class:"px-4 py-3 text-sm text-gray-700"},ye={class:"px-4 py-3 text-sm text-gray-700"},be={class:"px-4 py-3 text-sm"},we={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},$e={key:1},ke={class:"md:hidden space-y-3"},Ce={class:"flex justify-between items-start mb-2"},Me={class:"font-medium text-primary-dark"},Ae={class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},De={class:"grid grid-cols-2 gap-2 text-sm mt-2"},Be={key:0,class:"bg-white p-4 rounded-lg text-center text-gray-500 italic border border-dashed border-gray-300"},Ne={__name:"OverDueJobs",props:{overdueJobs:{type:Array,default:()=>[]}},setup(x){const p=g=>g?b(g).format("MMM D, YYYY"):"—",d=g=>{if(!g)return"No due date";const o=b().diff(b(g,"YYYY-MM-DD"),"day");return o>0?`Overdue ${o} day${o>1?"s":""}`:o===0?"Due today":`Due in ${Math.abs(o)} day${o<-1?"s":""}`};return(g,o)=>(s(),i("div",pe,[o[5]||(o[5]=e("h2",{class:"text-lg font-semibold mb-4"},"Overdue Jobs",-1)),e("div",ge,[e("table",ve,[o[1]||(o[1]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-sm font-medium text-gray-500"},"Job Title"),e("th",{class:"px-4 py-2 text-left text-sm font-medium text-gray-500"},"Customer"),e("th",{class:"px-4 py-2 text-left text-sm font-medium text-gray-500"},"Amount Due"),e("th",{class:"px-4 py-2 text-left text-sm font-medium text-gray-500"},"Due Date"),e("th",{class:"px-4 py-2 text-left text-sm font-medium text-gray-500"},"Status")])],-1)),x.overdueJobs.value.length>0?(s(),i("tbody",he,[(s(!0),i(M,null,A(x.overdueJobs.value,r=>{var y;return s(),i("tr",{key:r.id,class:"hover:bg-gray-50 transition-colors"},[e("td",xe,l(r.job_title),1),e("td",fe,l(((y=r.customer)==null?void 0:y.name)||"—"),1),e("td",_e,l(r.amount),1),e("td",ye,l(p(r.due_date)),1),e("td",be,[e("span",we,l(d(r.due_date)),1)])])}),128))])):(s(),i("tbody",$e,o[0]||(o[0]=[e("tr",null,[e("td",{colspan:"5",class:"py-4 text-center text-gray-500 italic"},"No overdue jobs")],-1)])))])]),e("div",ke,[(s(!0),i(M,null,A(x.overdueJobs.value,r=>{var y;return s(),i("div",{key:r.id,class:"bg-white p-4 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow"},[e("div",Ce,[e("h3",Me,l(r.job_title),1),e("span",Ae,l(d(r.due_date)),1)]),e("div",De,[e("div",null,[o[2]||(o[2]=e("p",{class:"text-gray-500 text-xs"},"Customer",-1)),e("p",null,l(((y=r.customer)==null?void 0:y.name)||"—"),1)]),e("div",null,[o[3]||(o[3]=e("p",{class:"text-gray-500 text-xs"},"Amount Due",-1)),e("p",null,l(r.amount),1)]),e("div",null,[o[4]||(o[4]=e("p",{class:"text-gray-500 text-xs"},"Due Date",-1)),e("p",null,l(p(r.due_date)),1)])])])}),128)),x.overdueJobs.value.length===0?(s(),i("div",Be," No overdue jobs ")):J("",!0)])]))}},Ze=L(Ne,[["__scopeId","data-v-9de5e345"]]);var O={exports:{}},Je=O.exports,F;function Oe(){return F||(F=1,(function(x,p){(function(d,g){x.exports=g()})(Je,(function(){return function(d,g,o){d=d||{};var r=g.prototype,y={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function c(t,v,n,f){return r.fromToBase(t,v,n,f)}o.en.relativeTime=y,r.fromToBase=function(t,v,n,f,_){for(var h,u,m,w=n.$locale().relativeTime||y,N=d.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],W=N.length,Z=0;Z<W;Z+=1){var C=N[Z];C.d&&(h=f?o(t).diff(n,C.d,!0):n.diff(t,C.d,!0));var D=(d.rounding||Math.round)(Math.abs(h));if(m=h>0,D<=C.r||!C.r){D<=1&&Z>0&&(C=N[Z-1]);var Y=w[C.l];_&&(D=_(""+D)),u=typeof Y=="string"?Y.replace("%d",D):Y(D,v,C.l,m);break}}if(v)return u;var S=m?w.future:w.past;return typeof S=="function"?S(u):S.replace("%s",u)},r.to=function(t,v){return c(t,v,this,!0)},r.from=function(t,v){return c(t,v,this)};var a=function(t){return t.$u?o.utc():o()};r.toNow=function(t){return this.to(a(this),t)},r.fromNow=function(t){return this.from(a(this),t)}}}))})(O)),O.exports}var Te=Oe();const Ye=X(Te);function Se(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M5.25 9a6.75 6.75 0 0 1 13.5 0v.75c0 2.123.8 4.057 2.118 5.52a.75.75 0 0 1-.297 1.206c-1.544.57-3.16.99-4.831 1.243a3.75 3.75 0 1 1-7.48 0 24.585 24.585 0 0 1-4.831-1.244.75.75 0 0 1-.298-1.205A8.217 8.217 0 0 0 5.25 9.75V9Zm4.502 8.9a2.25 2.25 0 1 0 4.496 0 25.057 25.057 0 0 1-4.496 0Z","clip-rule":"evenodd"})])}function Ve(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M7.5 5.25a3 3 0 0 1 3-3h3a3 3 0 0 1 3 3v.205c.933.085 1.857.197 2.774.334 1.454.218 2.476 1.483 2.476 2.917v3.033c0 1.211-.734 2.352-1.936 2.752A24.726 24.726 0 0 1 12 15.75c-2.73 0-5.357-.442-7.814-1.259-1.202-.4-1.936-1.541-1.936-2.752V8.706c0-1.434 1.022-2.7 2.476-2.917A48.814 48.814 0 0 1 7.5 5.455V5.25Zm7.5 0v.09a49.488 49.488 0 0 0-6 0v-.09a1.5 1.5 0 0 1 1.5-1.5h3a1.5 1.5 0 0 1 1.5 1.5Zm-3 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"}),e("path",{d:"M3 18.4v-2.796a4.3 4.3 0 0 0 .713.31A26.226 26.226 0 0 0 12 17.25c2.892 0 5.68-.468 8.287-1.335.252-.084.49-.189.713-.311V18.4c0 1.452-1.047 2.728-2.523 2.923-2.12.282-4.282.427-6.477.427a49.19 49.19 0 0 1-6.477-.427C4.047 21.128 3 19.852 3 18.4Z"})])}function Pe(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function Re(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.464 8.746c.227-.18.497-.311.786-.394v2.795a2.252 2.252 0 0 1-.786-.393c-.394-.313-.546-.681-.546-1.004 0-.323.152-.691.546-1.004ZM12.75 15.662v-2.824c.347.085.664.228.921.421.427.32.579.686.579.991 0 .305-.152.671-.579.991a2.534 2.534 0 0 1-.921.42Z"}),e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v.816a3.836 3.836 0 0 0-1.72.756c-.712.566-1.112 1.35-1.112 2.178 0 .829.4 1.612 1.113 2.178.502.4 1.102.647 1.719.756v2.978a2.536 2.536 0 0 1-.921-.421l-.879-.66a.75.75 0 0 0-.9 1.2l.879.66c.533.4 1.169.645 1.821.75V18a.75.75 0 0 0 1.5 0v-.81a4.124 4.124 0 0 0 1.821-.749c.745-.559 1.179-1.344 1.179-2.191 0-.847-.434-1.632-1.179-2.191a4.122 4.122 0 0 0-1.821-.75V8.354c.29.082.559.213.786.393l.415.33a.75.75 0 0 0 .933-1.175l-.415-.33a3.836 3.836 0 0 0-1.719-.755V6Z","clip-rule":"evenodd"})])}function Ee(x,p){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M5.25 6.375a4.125 4.125 0 1 1 8.25 0 4.125 4.125 0 0 1-8.25 0ZM2.25 19.125a7.125 7.125 0 0 1 14.25 0v.003l-.001.119a.75.75 0 0 1-.363.63 13.067 13.067 0 0 1-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 0 1-.364-.63l-.001-.122ZM18.75 7.5a.75.75 0 0 0-1.5 0v2.25H15a.75.75 0 0 0 0 1.5h2.25v2.25a.75.75 0 0 0 1.5 0v-2.25H21a.75.75 0 0 0 0-1.5h-2.25V7.5Z"})])}const Le={class:"bg-primary-light/10 shadow rounded-lg p-4 mb-8 w-full"},ze={class:"overflow-x-auto"},Fe={key:0,class:"space-y-3"},Ie={class:"flex gap-3 items-center"},qe={class:"flex flex-col sm:flex-row sm:items-center min-w-0 flex-1 gap-1 sm:gap-2"},He={class:"text-gray-500 font-medium"},We={class:"text-gray-500 text-sm whitespace-nowrap"},je={key:1,class:"p-6 text-center text-gray-500 border border-dashed border-gray-300 rounded-lg min-w-max"},Ge={class:"mt-4 flex sm:flex-row justify-between items-center gap-3 sm:gap-0"},Ke=["disabled"],Qe={class:"text-sm text-gray-600"},Ue=["disabled"],P=5,Xe={__name:"RecentActivities",props:{recentActivities:Object},setup(x){b.extend(Ye);const p=x,d=$(1),g=B(()=>Math.ceil(p.recentActivities.data.length/P)),o=B(()=>{const n=(d.value-1)*P;return p.recentActivities.data.slice(n,n+P)}),r=()=>{d.value<g.value&&d.value++},y=()=>{d.value>1&&d.value--},c=n=>b(n).fromNow(),a=n=>{var h,u,m;const f=n.changes?JSON.parse(n.changes):null,_=((h=n==null?void 0:n.customer)==null?void 0:h.name)||"a customer";switch(n.type){case"payment":return`You received a payment of $${f.amount} from ${_} via ${f.method}`;case"complete_job":return`You completed the job "${(u=n.subject)==null?void 0:u.job_title}" for ${_}`;case"job_created":return`You got a job "${(m=n.subject)==null?void 0:m.job_title}" from ${_}, Congrats!`;case"customer_created":return`New customer ${_} added, congrats!`;default:return"New activity logged"}},t=n=>({payment:"bg-secondary-500",complete_job:"bg-success-500",job_created:"bg-primary-500",customer_created:"bg-tertiary-500"})[n]||"bg-gray-500",v=n=>({payment:Re,complete_job:Pe,job_created:Ve,customer_created:Ee})[n]||Se;return(n,f)=>(s(),i("div",Le,[f[1]||(f[1]=e("h2",{class:"text-lg font-semibold mb-4"},"Recent Activities",-1)),e("div",ze,[o.value.length>0?(s(),i("ul",Fe,[(s(!0),i(M,null,A(o.value,_=>(s(),i("li",{key:_.id,class:"px-4 py-3 rounded-xl bg-white shadow-sm hover:shadow-md transition-all duration-200 border border-gray-100 hover:border-primary-100"},[e("div",Ie,[e("div",{class:k(["flex-shrink-0 flex items-center justify-center w-10 h-10 rounded-full",t(_.type)])},[(s(),T(E(v(_.type)),{class:"w-10 h-10 text-primary-light"}))],2),e("div",qe,[e("p",He,l(a(_))+", ",1),e("p",We,l(c(_.created_at)),1)])])]))),128))])):(s(),i("div",je,f[0]||(f[0]=[e("p",null,"No activities yet",-1)])))]),e("div",Ge,[e("button",{onClick:y,disabled:d.value===1,class:"px-4 py-2 text-sm rounded-md border border-gray-300 disabled:opacity-50 hover:bg-gray-50 transition-colors w-full sm:w-auto"}," Previous ",8,Ke),e("p",Qe," Page "+l(d.value)+" of "+l(g.value),1),e("button",{onClick:r,disabled:d.value===g.value,class:"px-4 py-2 text-sm rounded-md border border-gray-300 disabled:opacity-50 hover:bg-gray-50 transition-colors w-full sm:w-auto"}," Next ",8,Ue)])]))}},et={class:"p-6 bg-white rounded-2xl shadow-lg"},tt={class:"hidden md:block overflow-x-auto"},st={class:"w-full border-collapse"},ot={class:"p-3"},rt={class:"font-medium whitespace-nowrap"},at={class:"text-gray-500 whitespace-nowrap"},nt={class:"p-3 whitespace-nowrap"},lt={class:"p-3 font-medium whitespace-nowrap"},it={class:"p-3 text-green-600 whitespace-nowrap"},dt={class:"p-3 text-red-600 whitespace-nowrap"},ct={class:"p-3 whitespace-nowrap"},ut={class:"p-3 whitespace-nowrap"},mt={class:"md:hidden space-y-4"},pt={class:"flex justify-between items-start mb-3"},gt={class:"font-semibold text-primary-dark"},vt={class:"text-sm text-gray-500"},ht={class:"grid grid-cols-2 gap-4 mt-3"},xt={class:"font-medium"},ft={class:"font-medium"},_t={class:"font-medium"},yt={class:"text-green-600 font-medium"},bt={class:"text-red-600 font-medium"},wt={key:0,class:"p-6 text-center text-gray-500"},$t={__name:"OwingCustomers",props:{owingCustomers:{type:Array,required:!0}},setup(x){const p=x,d=c=>Number(c).toLocaleString(),g=c=>b(c).format("MMM D, YYYY"),o=c=>{var a;return((a=c==null?void 0:c.filter(t=>t.type==="payment"))==null?void 0:a.reduce((t,v)=>{const n=JSON.parse(v.changes);return t+Number(n.amount)},0))||0},r=B(()=>{var a;const c=[];return(a=p.owingCustomers.value)==null||a.forEach(t=>{var v;(v=t.jobs)==null||v.forEach(n=>{const f=o(n.activities),_=Number(n.amount)-f;_>0&&c.push({...n,customer:t,totalPaid:f,balance:_,overdueLabel:y(n.due_date)})})}),c}),y=c=>{if(!c)return"";const a=b().diff(b(c,"YYYY-MM-DD"),"day");return a>0?`${a} days overdue`:"Not yet due"};return(c,a)=>(s(),i("div",et,[a[6]||(a[6]=e("h2",{class:"text-xl font-semibold mb-4"},"Owing Customers",-1)),e("div",tt,[e("table",st,[a[0]||(a[0]=e("thead",null,[e("tr",{class:"bg-gray-50 text-left text-sm text-gray-600"},[e("th",{class:"p-3"},"Customer"),e("th",{class:"p-3"},"Job"),e("th",{class:"p-3"},"Amount"),e("th",{class:"p-3"},"Paid"),e("th",{class:"p-3"},"Balance"),e("th",{class:"p-3"},"Due Date"),e("th",{class:"p-3"},"Status")])],-1)),e("tbody",null,[(s(!0),i(M,null,A(r.value,t=>(s(),i("tr",{key:t.id,class:"border-t text-sm hover:bg-gray-50 transition-colors"},[e("td",ot,[e("div",rt,l(t.customer.name),1),e("div",at,l(t.customer.phone||t.customer.email),1)]),e("td",nt,[e("div",null,l(t.job_title),1)]),e("td",lt,"₦"+l(d(t.amount)),1),e("td",it,"₦"+l(d(t.totalPaid)),1),e("td",dt,"₦"+l(d(t.balance)),1),e("td",ct,l(g(t.due_date)),1),e("td",ut,[e("span",{class:k(["px-2 py-1 rounded-full text-xs font-medium inline-flex items-center",t.balance>0?"bg-red-100 text-red-600":"bg-green-100 text-green-600"])},[e("span",{class:k(["h-2 w-2 rounded-full mr-1",t.balance>0?"bg-red-600":"bg-green-600"])},null,2),R(" "+l(t.balance>0?`Owing (${t.overdueLabel})`:"Cleared"),1)],2)])]))),128))])])]),e("div",mt,[(s(!0),i(M,null,A(r.value,t=>(s(),i("div",{key:t.id,class:"p-4 border rounded-lg hover:shadow-md transition-shadow"},[e("div",pt,[e("div",null,[e("h3",gt,l(t.customer.name),1),e("p",vt,l(t.customer.phone||t.customer.email),1)]),e("span",{class:k(["px-2 py-1 rounded-full text-xs font-medium inline-flex items-center",t.balance>0?"bg-red-100 text-red-600":"bg-green-100 text-green-600"])},[e("span",{class:k(["h-2 w-2 rounded-full mr-1",t.balance>0?"bg-red-600":"bg-green-600"])},null,2),R(" "+l(t.balance>0?`Owing (${t.overdueLabel})`:"Cleared"),1)],2)]),e("div",ht,[e("div",null,[a[1]||(a[1]=e("p",{class:"text-xs text-gray-500"},"Job Title",-1)),e("p",xt,l(t.job_title),1)]),e("div",null,[a[2]||(a[2]=e("p",{class:"text-xs text-gray-500"},"Due Date",-1)),e("p",ft,l(g(t.due_date)),1)]),e("div",null,[a[3]||(a[3]=e("p",{class:"text-xs text-gray-500"},"Amount",-1)),e("p",_t,"₦"+l(d(t.amount)),1)]),e("div",null,[a[4]||(a[4]=e("p",{class:"text-xs text-gray-500"},"Paid",-1)),e("p",yt,"₦"+l(d(t.totalPaid)),1)]),e("div",null,[a[5]||(a[5]=e("p",{class:"text-xs text-gray-500"},"Balance",-1)),e("p",bt,"₦"+l(d(t.balance)),1)])])]))),128))]),r.value.length===0?(s(),i("div",wt," No customers owing ")):J("",!0)]))}},kt=L($t,[["__scopeId","data-v-307ae5b5"]]),Ct={class:""},Mt={class:"flex items-end relative z-10 pl-2 pt-2 bg-gray-100 dark:bg-gray-800 rounded-t-lg"},At=["onClick"],Dt={class:"font-medium text-sm flex items-center gap-2"},Bt={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"},Nt={class:"bg-white rounded-b-lg rounded-tr-lg shadow-lg relative -mt-1 z-0"},Zt={key:0,class:"rounded-lg min-w-0"},Jt={class:"relative overflow-hidden"},Ot={__name:"Dashboard",props:{jobs:Array,recentActivities:Array,customers:Array},setup(x){let p=x,d=$([]),g=$();const o=[{id:1,label:"Overdue Jobs",component:Ze,props:{overdueJobs:d}},{id:3,label:"Accounts Receivable",component:kt,props:{owingCustomers:g}},{id:2,label:" Recent Activity",component:Xe,props:{recentActivities:p.recentActivities}}],r=$(o[0].id);function y(c){const a=new Date;return c.filter(t=>t.jobs.some(v=>{const n=parseFloat(v.amount),f=v.activities.filter(m=>m.type==="payment").reduce((m,w)=>{const N=JSON.parse(w.changes);return m+parseFloat(N.amount)},0),_=n-f,h=new Date(v.due_date);return _>0&&v.status==="completed"&&h<a}))}return I(()=>{d.value=p.jobs.filter(c=>c.status!=="completed"&&b(c.due_date).isBefore(b(),"day")),g.value=y(p.customers.data)}),(c,a)=>(s(),T(j,null,{default:H(()=>[e("div",Ct,[q(me),a[0]||(a[0]=e("div",{class:"flex items-center justify-between my-3"},[e("div",null,[e("h2",{class:"text-xl font-semibold text-primary-dark flex items-center justify-start"},[e("svg",{class:"w-5 h-5 text-primary-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("span",{class:"text-2xl font-semibold text-gray-900 relative inline-block ml-2"},[R(" Client Management "),e("span",{class:"absolute bottom-0 left-0 h-0.5 w-12 bg-primary-dark rounded-full"})]),e("span",{class:"ml-3 text-xs font-normal text-gray-400"},"OVERVIEW")]),e("p",{class:"text-sm text-gray-500 ml-8 mt-1"}," Monitor your business health at a glance ")])],-1)),e("div",null,[e("div",Mt,[(s(),i(M,null,A(o,t=>e("button",{key:t.id,onClick:v=>r.value=t.id,class:k(["relative px-4 py-2 rounded-t-lg mr-1 transition-all duration-200",{"bg-white  text-primary shadow-[0_1px_0_0_rgba(255,255,255,0.7),1px_0_3px_-1px_rgba(0,0,0,0.1),-1px_0_3px_-1px_rgba(0,0,0,0.1)]":r.value===t.id,"bg-primary text-tertiary-light hover:bg-primary-dark":r.value!==t.id}])},[e("p",Dt,l(t.label),1),r.value===t.id?(s(),i("span",Bt)):J("",!0)],10,At)),64))]),e("div",Nt,[(s(),i(M,null,A(o,t=>e("div",{key:t.id},[r.value===t.id?(s(),i("section",Zt,[e("div",Jt,[(s(),T(E(t.component),ee({ref_for:!0},t.props||[],{class:"w-full"}),null,16))])])):J("",!0)])),64))])])])]),_:1}))}},Et=L(Ot,[["__scopeId","data-v-ff1c8744"]]);export{Et as default};
