import{m as A,j as L,A as E,s as J,g as n,o as i,K as N,i as y,F as g,H as v,b as t,f as c,t as l,n as f,d as w,a as U,w as $,l as z,y as k}from"./app-b2jftaPc.js";import{d as D}from"./dayjs.min-SuAGmzRC.js";const B={class:"bg-white rounded-xl shadow-sm border border-tertiary-light overflow-hidden"},F={class:"flex flex-col space-y-2 md:col-span-3 md:flex-row md:items-center md:space-y-0 md:space-x-3"},V={class:"flex-shrink-0 h-10 w-10 rounded-full overflow-hidden bg-primary-light/10 flex items-center justify-center text-primary-DEFAULT font-medium"},H=["src"],T={class:"font-medium text-primary-dark"},S={class:"text-sm text-gray-500"},Y={class:"mt-2 md:mt-0 md:col-span-2"},Q={class:"text-primary-dark"},q={class:"text-sm text-gray-500 truncate"},K={class:"hidden md:block md:col-span-3"},P={class:"flex flex-col space-y-2"},R={class:"text-sm text-gray-600 whitespace-nowrap"},G={class:"text-xs text-gray-400 ml-1"},I={class:"mt-2 md:mt-0 md:col-span-2"},O={class:"flex items-center"},W={class:"text-sm font-medium text-primary-dark mr-2"},X={class:"mt-3 md:mt-0 md:col-span-2 flex items-center space-x-2"},Z=["onClick"],ee=["onClick"],te={key:0,class:"p-12 text-center"},se={__name:"CustomerList",props:{searchQuery:String,newUpdate:String},emits:["openAddCustomerModal","isEditing","update"],setup(b,{emit:_}){const o=b;let r=A([]),p=_;const h=L(()=>{if(!o.searchQuery)return r.value;const d=o.searchQuery.toLowerCase();return r.value.filter(a=>a.name.toLowerCase().includes(d)||a.company.toLowerCase().includes(d)||a.email.toLowerCase().includes(d)||a.phone.toLowerCase().includes(d))}),u=d=>{p(["openAddCustomerModal"])},C=d=>{p("isEditing",{payload:d})};E(o.newUpdate,()=>{console.log(o.newUpdate)},{deep:!0});const x=()=>{k.get("/get_customer").then(d=>{r.value=d.data.map(a=>({...a,initials:a.name.split(" ").map(e=>e[0]).join("").toUpperCase()}))})};J(()=>{x()});const M=d=>{confirm(`Are you sure you want to delete "${d.name}"?`)&&k.delete(`/customer_delete/${d.id}`).then(a=>{a.status===200&&(p("update"),alert(a.data.message),x())}).catch(a=>{console.error("Error deleting job:",a),alert("Failed to delete job. Please try again.")})};return(d,a)=>(i(),n("div",B,[a[6]||(a[6]=N('<div class="grid grid-cols-12 gap-4 px-6 py-4 bg-tertiary-light/50 border-b border-tertiary-light"><div class="col-span-4 md:col-span-3 font-medium text-primary-dark">Customer</div><div class="col-span-4 md:col-span-2 font-medium text-primary-dark">Contact</div><div class="hidden md:block md:col-span-3 font-medium text-primary-dark">Recent Activity</div><div class="col-span-4 md:col-span-2 font-medium text-primary-dark">Jobs</div><div class="col-span-4 md:col-span-2 font-medium text-primary-dark text-right">Actions</div></div>',1)),(i(!0),n(g,null,v(h.value,e=>{var m;return i(),n("div",{key:e==null?void 0:e.id,class:"px-4 py-4 border-b border-tertiary-light hover:bg-tertiary-light/20 transition-colors md:grid md:grid-cols-12 md:gap-4 md:items-center"},[t("div",F,[t("div",V,[e.avatar?(i(),n("img",{key:0,src:`/storage/${e.avatar}`,alt:"Avatar",class:"object-cover w-full h-full"},null,8,H)):(i(),n(g,{key:1},[c(l(e==null?void 0:e.initials),1)],64))]),t("div",null,[t("p",T,l(e==null?void 0:e.name),1),t("p",S,l(e==null?void 0:e.company),1)])]),t("div",Y,[t("p",Q,l(e==null?void 0:e.phone),1),t("p",q,l((e==null?void 0:e.email)||"No email"),1)]),t("div",K,[t("div",P,[(i(!0),n(g,null,v(e.activities,(s,j)=>(i(),n("div",{key:j,class:"flex items-center space-x-2"},[t("div",{class:f(["h-2 w-2 rounded-full",{"bg-green-500":s.type==="completed","bg-secondary":(e==null?void 0:e.type)==="payment","bg-primary":(e==null?void 0:e.type)==="job"}])},null,2),t("p",R,[c(l((s==null?void 0:s.type)||"No activity")+" ",1),t("span",G,l(w(D)(s==null?void 0:s.created_at).format("DD-MMM-YYYY")||""),1)])]))),128))])]),t("div",I,[t("div",O,[t("span",W,l(((m=e.jobs)==null?void 0:m.length)||0),1),((e==null?void 0:e.pendingJobs)||0)>0||((e==null?void 0:e.overdueJobs)||0)>0?(i(),n("span",{key:0,class:f(["px-2 py-0.5 rounded-full text-xs font-medium",{"bg-secondary-light/20 text-secondary-dark":((e==null?void 0:e.pendingJobs)||0)>0,"bg-red-100 text-red-800":((e==null?void 0:e.overdueJobs)||0)>0}])},l((e==null?void 0:e.overdueJobs)>0?`${e.overdueJobs} overdue`:`${e.pendingJobs} pending`),3)):y("",!0)])]),t("div",X,[U(w(z),{href:`/customer/${e.id}`,class:"p-2 rounded-lg hover:bg-tertiary-light text-primary-DEFAULT",title:"View"},{default:$(()=>a[0]||(a[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])),_:2,__:[0]},1032,["href"]),t("button",{onClick:s=>C(e),class:"p-2 rounded-lg hover:bg-tertiary-light text-primary-DEFAULT",title:"Edit"},a[1]||(a[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Z),t("button",{onClick:s=>M(e),class:"p-2 rounded-lg hover:bg-tertiary-light text-red-500",title:"Edit"}," Delete ",8,ee)]),a[2]||(a[2]=t("div",{class:"block md:hidden mt-3"},[t("hr",{class:"w-full border-t border-tertiary-dark"})],-1))])}),128)),h.value.length===0?(i(),n("div",te,[a[3]||(a[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),a[4]||(a[4]=t("h3",{class:"mt-2 text-lg font-medium text-primary-dark"},"No customers found",-1)),a[5]||(a[5]=t("p",{class:"mt-1 text-gray-500"},"Try adjusting your search or add a new customer",-1)),t("button",{onClick:u,class:"mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"}," Add Customer ")])):y("",!0)]))}};export{se as _};
