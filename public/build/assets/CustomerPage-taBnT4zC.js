import{m as c,j as Q,p as z,g as d,o,L as B,i as k,F as _,q as C,b as t,f as M,t as m,n as j,d as g,a as w,w as A,l as T,z as $,k as U,K as D,M as S,c as E,e as J,C as N}from"./app-QB0zDPA2.js";import{d as V}from"./dayjs.min-Co4sUPww.js";import{a as F,_ as H}from"./AuthenticatedLayout-Cf9bjmOJ.js";import{r as Y}from"./PlusIcon-DHVdqDQ0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"bg-white rounded-xl shadow-sm border border-tertiary-light overflow-hidden"},q={class:"flex flex-col space-y-2 md:col-span-3 md:flex-row md:items-center md:space-y-0 md:space-x-3"},K={class:"flex-shrink-0 h-10 w-10 rounded-full overflow-hidden bg-primary-light/10 flex items-center justify-center text-primary-DEFAULT font-medium"},R=["src"],I={class:"font-medium text-primary-dark"},G={class:"text-sm text-gray-500"},O={class:"mt-2 md:mt-0 md:col-span-2"},W={class:"text-primary-dark"},X={class:"text-sm text-gray-500 truncate"},Z={class:"hidden md:block md:col-span-3"},ee={class:"flex flex-col space-y-2"},te={class:"text-sm text-gray-600 whitespace-nowrap"},se={class:"text-xs text-gray-400 ml-1"},ae={class:"mt-2 md:mt-0 md:col-span-2"},re={class:"flex items-center"},oe={class:"text-sm font-medium text-primary-dark mr-2"},ne={class:"mt-3 md:mt-0 md:col-span-2 flex items-center space-x-2"},de=["onClick"],le=["onClick"],ie={key:0,class:"p-12 text-center"},pe={__name:"CustomerList",props:{searchQuery:String,newUpdate:String},emits:["openAddCustomerModal","isEditing","update"],setup(b,{emit:h}){const r=b;let p=c([]),l=h;const x=Q(()=>{if(!r.searchQuery)return p.value;const a=r.searchQuery.toLowerCase();return p.value.filter(s=>{var e,y,n;return s.name.toLowerCase().includes(a)||((e=s.company)==null?void 0:e.toLowerCase().includes(a))||((y=s.email)==null?void 0:y.toLowerCase().includes(a))||((n=s.phone)==null?void 0:n.toLowerCase().includes(a))})}),i=a=>{l(["openAddCustomerModal"])},u=a=>{l("isEditing",{payload:a})},f=()=>{$.get("/get_customer").then(a=>{p.value=a.data.map(s=>({...s,initials:s.name.split(" ").map(e=>e[0]).join("").toUpperCase()}))})};z(()=>{f()});const v=a=>{confirm(`Are you sure you want to delete "${a.name}"?`)&&$.delete(`/customer_delete/${a.id}`).then(s=>{s.status===200&&(l("update"),alert(s.data.message),f())}).catch(s=>{console.error("Error deleting job:",s),alert("Failed to delete job. Please try again.")})};return(a,s)=>(o(),d("div",P,[s[6]||(s[6]=B('<div class="grid grid-cols-12 gap-4 px-6 py-4 bg-tertiary-light/50 border-b border-tertiary-light"><div class="col-span-4 md:col-span-3 font-medium text-primary-dark">Customer</div><div class="col-span-4 md:col-span-2 font-medium text-primary-dark">Contact</div><div class="hidden md:block md:col-span-3 font-medium text-primary-dark">Recent Activity</div><div class="col-span-4 md:col-span-2 font-medium text-primary-dark">Jobs</div><div class="col-span-4 md:col-span-2 font-medium text-primary-dark text-right">Actions</div></div>',1)),(o(!0),d(_,null,C(x.value,e=>{var y;return o(),d("div",{key:e==null?void 0:e.id,class:"px-4 py-4 border-b border-tertiary-light hover:bg-tertiary-light/20 transition-colors md:grid md:grid-cols-12 md:gap-4 md:items-center"},[t("div",q,[t("div",K,[e.avatar?(o(),d("img",{key:0,src:`/storage/${e.avatar}`,alt:"Avatar",class:"object-cover w-full h-full"},null,8,R)):(o(),d(_,{key:1},[M(m(e==null?void 0:e.initials),1)],64))]),t("div",null,[t("p",I,m(e==null?void 0:e.name),1),t("p",G,m(e==null?void 0:e.company),1)])]),t("div",O,[t("p",W,m(e==null?void 0:e.phone),1),t("p",X,m((e==null?void 0:e.email)||"No email"),1)]),t("div",Z,[t("div",ee,[(o(!0),d(_,null,C(e.activities,(n,L)=>(o(),d("div",{key:L,class:"flex items-center space-x-2"},[t("div",{class:j(["h-2 w-2 rounded-full",{"bg-green-500":n.type==="completed","bg-secondary":(e==null?void 0:e.type)==="payment","bg-primary":(e==null?void 0:e.type)==="job"}])},null,2),t("p",te,[M(m((n==null?void 0:n.type)||"No activity")+" ",1),t("span",se,m(g(V)(n==null?void 0:n.created_at).format("DD-MMM-YYYY")||""),1)])]))),128))])]),t("div",ae,[t("div",re,[t("span",oe,m(((y=e.jobs)==null?void 0:y.length)||0),1),((e==null?void 0:e.pendingJobs)||0)>0||((e==null?void 0:e.overdueJobs)||0)>0?(o(),d("span",{key:0,class:j(["px-2 py-0.5 rounded-full text-xs font-medium",{"bg-secondary-light/20 text-secondary-dark":((e==null?void 0:e.pendingJobs)||0)>0,"bg-red-100 text-red-800":((e==null?void 0:e.overdueJobs)||0)>0}])},m((e==null?void 0:e.overdueJobs)>0?`${e.overdueJobs} overdue`:`${e.pendingJobs} pending`),3)):k("",!0)])]),t("div",ne,[w(g(T),{href:`/customer/${e.id}`,class:"p-2 rounded-lg hover:bg-tertiary-light text-primary-DEFAULT",title:"View"},{default:A(()=>s[0]||(s[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])),_:2,__:[0]},1032,["href"]),t("button",{onClick:n=>u(e),class:"p-2 rounded-lg hover:bg-tertiary-light text-primary-DEFAULT",title:"Edit"},s[1]||(s[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,de),t("button",{onClick:n=>v(e),class:"p-2 rounded-lg hover:bg-tertiary-light text-red-500",title:"Edit"}," Delete ",8,le)]),s[2]||(s[2]=t("div",{class:"block md:hidden mt-3"},[t("hr",{class:"w-full border-t border-tertiary-dark"})],-1))])}),128)),x.value.length===0?(o(),d("div",ie,[s[3]||(s[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),s[4]||(s[4]=t("h3",{class:"mt-2 text-lg font-medium text-primary-dark"},"No customers found",-1)),s[5]||(s[5]=t("p",{class:"mt-1 text-gray-500"},"Try adjusting your search or add a new customer",-1)),t("button",{onClick:i,class:"mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"}," Add Customer ")])):k("",!0)]))}},me={class:"relative"},ce={__name:"SearchComponent",emits:["sendSearchQuery"],setup(b,{emit:h}){let r=c(),p=h;const l=()=>{p("sendSearchQuery",{payload:r.value})};return(x,i)=>(o(),d("div",me,[U(t("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=u=>S(r)?r.value=u:r=u),onKeyup:i[1]||(i[1]=u=>l(g(r))),placeholder:"Search customers...",class:"pl-10 pr-4 py-2 border border-tertiary-dark rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light focus:border-primary-light"},null,544),[[D,g(r)]]),i[2]||(i[2]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 absolute left-3 top-2.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]))}},ue={class:"space-y-6"},ge={class:"flex flex-col justify-between gap-4 md:flex-row md:items-center bg-primary-light/10 p-6 rounded-xl shadow-inner border border-primary/20"},he={class:"flex flex-col md:flex-row xs:flex-row gap-3 w-full md:w-auto items-stretch"},fe={class:"flex items-center gap-3 w-full"},be={__name:"CustomerPage",setup(b){c(0);const h=c("");let r=c(!1),p=c({});c("");let l=c(!1);const x=({payload:s})=>{h.value=s},i=({payload:s})=>{r.value=!0,p.value=s,v()},u=()=>{N.reload()},f=c(!1),v=()=>{f.value=!0},a=()=>{f.value=!1,r.value=!1,p.value={}};return(s,e)=>(o(),E(H,null,{default:A(()=>[f.value===!0?(o(),d("div",{key:0,onClick:J(a,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},[w(F,{customerToEdit:g(p),isEditing:g(r),onCloseAddCustomerModal:a,onCustomerCreated_Updated:u},null,8,["customerToEdit","isEditing"])])):k("",!0),t("div",ue,[t("div",ge,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-2xl font-bold text-primary-dark"},"Customers"),t("p",{class:"mt-1 text-sm text-secondary-dark/80"},"Manage your customer relationships")],-1)),t("div",he,[t("div",fe,[g(l)||!s.isMobile?(o(),E(ce,{key:0,onSendSearchQuery:x,class:"flex-1",onClose:e[0]||(e[0]=y=>S(l)?l.value=!1:l=!1)})):k("",!0),t("button",{class:"inline-flex items-center justify-center px-4 py-2.5 bg-primary hover:bg-primary-dark text-white rounded-lg transition-all duration-200 hover:shadow-md hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-primary/50 flex-shrink-0",onClick:v},[w(g(Y),{class:"w-5 h-5 md:mr-2"}),e[1]||(e[1]=t("span",{class:"hidden md:inline"},"Add Customer",-1))])])])]),w(pe,{class:"mt-6 animate-fade-in",onUpdate:u,searchQuery:h.value,onIsEditing:i},null,8,["searchQuery"])])]),_:1}))}};export{be as default};
