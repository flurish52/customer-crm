import{_ as B}from"./AuthenticatedLayout-DgHnd84g.js";import O from"./InvoiceFooter-DC8rz3TI.js";import{m as x,j as l,o as i,b as e,k as d,f as m,e as U,i as y,v as T,n as _,t as o,I as E,J as N,d as h,H as I,g as j,z as J,E as L,c as P,w as z,a as M,h as H,F as R,q as A}from"./app-CAzgmfma.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col"},G={class:"overflow-y-auto flex-1 px-6"},W={class:"py-5 border-b border-gray-100"},Q={class:"flex items-center space-x-3 cursor-pointer"},K={class:"relative inline-block w-12 h-6 rounded-full bg-gray-300"},X={class:"text-gray-700"},Y={class:"text-indigo-600 font-semibold ml-1"},Z={class:"py-5 border-b border-gray-100"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},te=["disabled"],se={class:"py-1 border-b border-gray-100"},oe={class:"space-y-3 bg-gray-50 p-2 rounded-lg border border-gray-100"},ne={class:"flex items-center space-x-3 p-1 rounded-md hover:bg-white transition-colors duration-150 cursor-pointer"},ie={class:"text-gray-700"},le={class:"text-indigo-600 font-medium"},ae={class:"flex items-center space-x-3 p-1 rounded-md hover:bg-white transition-colors duration-150 cursor-pointer"},re={class:"text-gray-700"},de={class:"text-indigo-600 font-medium"},ue={class:"flex items-center space-x-3 p-1 rounded-md hover:bg-white transition-colors duration-150 cursor-pointer"},ce={class:"text-gray-700"},me={class:"text-indigo-600 font-medium"},ve={class:"py-5"},pe={class:"mb-4"},ge={class:"w-full"},be={class:"text-center text-red-600 text-xs p-1"},xe={class:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50"},fe=["disabled"],ye={__name:"SendInvoiceModal",props:{invoice:Object,personalEmail:String,businessEmail:String},setup(n){const p=n,c=x(!1),v=x(!1),u=x(""),b=x(""),f=x(""),w=x("");let C=x(JSON.parse(p.invoice.business_snapshot).email),g=x(""),t=x(""),r=x(!1);const $=()=>{c.value=!0},k=()=>{c.value=!1,w.value="",t.value="",g.value="",b.value=""},D=async()=>{var a;const S=j(()=>t.value==="business"?p.businessEmail:t.value==="personal"?p.personalEmail:t.value==="receipt"?C.value:null),s=v.value?JSON.parse(p.invoice.business_snapshot).email:w.value;if(!s){alert("Please provide a client email.");return}r.value=!0;try{await J.post(`/invoice/${p.invoice.id}/send`,{replyToEmail:S.value,email:s,from_name:u.value||JSON.parse(p.invoice.business_snapshot).name,subject:b.value||`Invoice #${p.invoice.id}`,message:f.value}),alert("Email sent successfully"),r.value=!1,k(),L.visit(`/dashboard/invoice/${p.invoice.id}`)}catch(V){g.value=((a=V.response)==null?void 0:a.data.message)||V.message,alert("Failed to send email,"),r.value=!1}};return(S,s)=>(i(),l("div",null,[e("button",{onClick:$,class:"bg-indigo-600 text-white px-5 py-2.5 rounded-lg hover:bg-indigo-700 transition-all duration-200 flex items-center gap-2 shadow-md hover:shadow-lg"},s[8]||(s[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 12H8m0 0H6a2 2 0 00-2 2v4a2 2 0 002 2h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2"})],-1),m(" Share via Email ",-1)])),c.value?(i(),l("div",{key:0,onClick:U(k,["self"]),class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4 backdrop-blur-sm"},[e("div",F,[e("div",{class:"flex items-center justify-between p-6 border-b border-gray-200"},[s[10]||(s[10]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Send Invoice",-1)),e("button",{onClick:k,class:"text-gray-400 hover:text-gray-600 transition-colors"},s[9]||(s[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",G,[e("div",W,[s[12]||(s[12]=e("h3",{class:"text-lg font-medium text-gray-800 mb-3 flex items-center gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),m(" Client Email ")],-1)),e("label",Q,[e("div",K,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=a=>v.value=a),class:"absolute w-0 h-0 opacity-0"},null,512),[[T,v.value]]),e("span",{class:_(["toggle-label absolute cursor-pointer top-0 left-0 right-0 bottom-0 rounded-full transition duration-200",{"bg-indigo-100":v.value}])},null,2),e("span",{class:_(["absolute bg-white border border-gray-300 rounded-full h-5 w-5 top-0.5 transition-all duration-200 transform",{"translate-x-6 bg-indigo-500":v.value}])},null,2)]),e("span",X,[s[11]||(s[11]=m("Use Client email ",-1)),e("span",Y,o(JSON.parse(n.invoice.business_snapshot).email),1)])])]),e("div",Z,[s[15]||(s[15]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4 flex items-center gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})]),m(" Recipient Information ")],-1)),e("div",ee,[e("div",null,[s[13]||(s[13]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"Recipient Email",-1)),y(e("input",{type:"email",class:"w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 transition-colors duration-200",disabled:v.value,"onUpdate:modelValue":s[1]||(s[1]=a=>w.value=a),placeholder:"Enter email address"},null,8,te),[[E,w.value]])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"From Name",-1)),y(e("input",{type:"text",class:"w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 transition-colors duration-200","onUpdate:modelValue":s[2]||(s[2]=a=>u.value=a),placeholder:"e.g. Business name",required:""},null,512),[[E,u.value]])])])]),e("div",se,[s[19]||(s[19]=e("h3",{class:"text-lg font-medium text-gray-800 mb-3 flex items-center gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})]),m(" Reply-To Email ")],-1)),s[20]||(s[20]=e("p",{class:"px-4 text-red-600 text-xs italic"},"Where do you want your client to reply to??",-1)),e("div",oe,[e("label",ne,[y(e("input",{type:"radio",value:"business","onUpdate:modelValue":s[3]||(s[3]=a=>I(t)?t.value=a:t=a),class:"text-indigo-600 focus:ring-indigo-500 h-4 w-4"},null,512),[[N,h(t)]]),e("span",ie,[s[16]||(s[16]=m("Business email ",-1)),e("span",le,"("+o(n.businessEmail)+")",1)])]),e("label",ae,[y(e("input",{type:"radio",value:"personal","onUpdate:modelValue":s[4]||(s[4]=a=>I(t)?t.value=a:t=a),class:"text-indigo-600 focus:ring-indigo-500 h-4 w-4"},null,512),[[N,h(t)]]),e("span",re,[s[17]||(s[17]=m("Personal email ",-1)),e("span",de,"("+o(n.personalEmail)+")",1)])]),e("label",ue,[y(e("input",{type:"radio",value:"receipt","onUpdate:modelValue":s[5]||(s[5]=a=>I(t)?t.value=a:t=a),class:"text-indigo-600 focus:ring-indigo-500 h-4 w-4"},null,512),[[N,h(t)]]),e("span",ce,[s[18]||(s[18]=m("Email on invoice ",-1)),e("span",me,"("+o(h(C))+")",1)])])])]),e("div",ve,[s[23]||(s[23]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4 flex items-center gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),m(" Message Content ")],-1)),e("div",pe,[s[21]||(s[21]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"Subject",-1)),y(e("input",{type:"text",class:"w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 transition-colors duration-200","onUpdate:modelValue":s[6]||(s[6]=a=>b.value=a),placeholder:"Enter email subject",required:""},null,512),[[E,b.value]])]),e("div",null,[s[22]||(s[22]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},[m("Message "),e("span",{class:"text-gray-500 font-normal"},"(optional)")],-1)),y(e("textarea",{class:"w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-500 transition-colors duration-200",rows:"3","onUpdate:modelValue":s[7]||(s[7]=a=>f.value=a),placeholder:"Write a message"},null,512),[[E,f.value]])])])]),e("div",ge,[e("p",be,o(h(g)),1),e("div",xe,[e("button",{onClick:k,class:"px-5 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200 font-medium"}," Cancel "),e("button",{onClick:D,disabled:h(r),class:_([h(r)?"bg-gray-500 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700","text-white px-5 py-2.5 rounded-lg transition-all duration-200 font-medium shadow-md flex items-center gap-2"])},s[24]||(s[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1),m(" Send Invoice ",-1)]),10,fe)])])])])):d("",!0)]))}},he={ref:"invoiceContainer",id:"invoiceContainer",class:"max-w-5xl mx-auto p-8 bg-white text-gray-800 shadow-lg rounded-lg"},we={class:"flex justify-between items-start mb-8 pb-6 border-b-2 border-gray-200"},ke={class:"flex items-start"},_e={key:0,class:"mr-4"},Ce=["src","alt"],$e={class:"text-2xl font-bold text-primary mb-2"},Ee={class:"text-gray-500 mb-1"},je={class:"text-gray-500"},Ne={key:0},Ie={key:1},Me={key:2},Se={class:"text-right"},Ve={class:"space-y-1"},De={id:"billToAndJob",class:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"},Be={class:"space-y-1"},Oe={class:"font-bold"},Ue={key:0},Te={key:1},Je={key:2},Le={key:0},Pe={class:"space-y-2"},ze={key:0,class:"font-semibold"},He={key:1},Re={key:2},Ae={key:0},qe={key:1},Fe={key:3},Ge={id:"invoiceItems",class:"mb-8"},We={class:"border border-gray-200 rounded overflow-hidden"},Qe={class:"font-bold"},Ke={key:0,class:"text-gray-500 text-sm mt-1"},Xe={class:"mb-8 flex justify-end"},Ye={class:"w-full md:w-72 space-y-2"},Ze={class:"flex justify-between font-bold"},et={key:0,class:"flex justify-between"},tt={key:1,class:"flex justify-between"},st={class:"flex justify-between border-t-2 border-gray-200 pt-2 font-bold text-lg"},ot={class:"flex flex-col items-center justify-center"},nt={class:"pt-8 border-t-2 border-gray-200 text-center"},it={key:0,class:"mb-6 text-center"},lt={class:"text-gray-500 text-sm italic leading-relaxed"},at={class:"w-full flex items-center justify-center gap-4 py-2 m-1"},rt={__name:"View",props:{invoice:Object,user:Object},setup(n){const p=n,c=j(()=>JSON.parse(p.invoice.business_snapshot)),v=j(()=>JSON.parse(p.invoice.customer_snapshot)),u=j(()=>JSON.parse(p.invoice.job_snapshot)),b=g=>new Intl.NumberFormat("en-NG",{style:"currency",currency:p.invoice.currency||"NGN"}).format(Number(g)),f=g=>g?new Date(g).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"—",w=g=>({PAID:"bg-green-600 text-white px-2 py-0.5 rounded",PENDING:"bg-yellow-500 text-white px-2 py-0.5 rounded",OVERDUE:"bg-red-600 text-white px-2 py-0.5 rounded",CANCELLED:"bg-gray-500 text-white px-2 py-0.5 rounded",IN_PROGRESS:"bg-yellow-400 text-white px-2 py-0.5 rounded"})[g.toUpperCase()]||"bg-gray-400 text-white px-2 py-0.5 rounded",C=({invoiceContainer:g})=>{const t=document.getElementById("invoiceContainer");if(console.log(t),!t)return;const r=window.open("","","width=800,height=600"),$=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')).map(k=>k.outerHTML).join("");r.document.write(`
        <html>
        <head>
            <title>Print Invoice</title>
        ${$}
        </head>
        <body>
            ${t.innerHTML}
        </body>
        </html>
    `),r.document.close(),r.focus(),r.print(),r.close()};return(g,t)=>(i(),P(B,null,{default:z(()=>[M(h(H),{title:"Invoice"}),e("div",he,[e("header",we,[e("div",ke,[c.value.logo?(i(),l("div",_e,[e("img",{src:`/storage/${c.value.logo}`,alt:`${c.value.name} logo`,class:"w-20 h-20 object-contain"},null,8,Ce)])):d("",!0),e("div",null,[e("h1",$e,o(c.value.name),1),e("p",Ee,o(c.value.address),1),e("p",je,[c.value.phone?(i(),l("span",Ne,o(c.value.phone),1)):d("",!0),c.value.phone&&c.value.email?(i(),l("span",Ie," • ")):d("",!0),c.value.email?(i(),l("span",Me,o(c.value.email),1)):d("",!0)])])]),e("div",Se,[t[4]||(t[4]=e("h2",{class:"text-xl font-semibold mb-4"},"INVOICE",-1)),e("div",Ve,[e("div",null,[t[0]||(t[0]=e("span",{class:"font-bold mr-2"},"Invoice #:",-1)),e("span",null,o(n.invoice.invoice_number),1)]),e("div",null,[t[1]||(t[1]=e("span",{class:"font-bold mr-2"},"Date:",-1)),e("span",null,o(f(n.invoice.issue_date)),1)]),e("div",null,[t[2]||(t[2]=e("span",{class:"font-bold mr-2"},"Due Date:",-1)),e("span",null,o(f(n.invoice.due_date)),1)]),e("div",null,[t[3]||(t[3]=e("span",{class:"font-bold mr-2"},"Status:",-1)),e("span",{class:_(w(n.invoice.status))},o(n.invoice.status.toUpperCase()),3)])])])]),e("section",De,[e("div",null,[t[5]||(t[5]=e("h3",{class:"text-blue-600 text-lg mb-4 border-b border-gray-200 pb-2"},"Bill To",-1)),e("div",Be,[e("p",Oe,o(v.value.name),1),v.value.company?(i(),l("p",Ue,o(v.value.company),1)):d("",!0),v.value.phone?(i(),l("p",Te,o(v.value.phone),1)):d("",!0),v.value.email?(i(),l("p",Je,o(v.value.email),1)):d("",!0)])]),u.value?(i(),l("div",Le,[t[7]||(t[7]=e("h3",{class:"text-blue-600 text-lg mb-4 border-b border-gray-200 pb-2"},"Job Details",-1)),e("div",Pe,[u.value.title?(i(),l("p",ze,o(u.value.title),1)):d("",!0),u.value.description?(i(),l("p",He,o(u.value.description),1)):d("",!0),u.value.start_date||u.value.due_date?(i(),l("div",Re,[u.value.start_date?(i(),l("span",Ae,o(f(u.value.start_date)),1)):d("",!0),u.value.due_date?(i(),l("span",qe," - "+o(f(u.value.due_date)),1)):d("",!0)])):d("",!0),u.value.status?(i(),l("p",Fe,[t[6]||(t[6]=m(" Status: ",-1)),e("span",{class:_(w(u.value.status))},o(u.value.status.toUpperCase()),3)])):d("",!0)])])):d("",!0)]),e("section",Ge,[t[12]||(t[12]=e("h3",{class:"text-blue-600 text-lg mb-4 border-b border-gray-200 pb-2"},"Invoice Items",-1)),e("div",We,[t[11]||(t[11]=e("div",{class:"grid grid-cols-4 bg-primary-dark text-white font-bold p-4"},[e("div",null,"Description"),e("div",null,"Qty"),e("div",null,"Unit Price"),e("div",null,"Amount")],-1)),(i(!0),l(R,null,A(n.invoice.items,(r,$)=>(i(),l("div",{key:r.id,id:"invoiceItemsDetails",class:"grid grid-cols-4 gap-2 md:gap-0 p-4 border-b border-gray-200 items-center last:border-b-0"},[e("div",null,[e("div",Qe,o(r.name),1),r.description?(i(),l("div",Ke,o(r.description),1)):d("",!0)]),e("div",null,[t[8]||(t[8]=e("span",{class:"font-bold md:hidden print:hidden"},"Quantity: ",-1)),m(o(r.quantity),1)]),e("div",null,[t[9]||(t[9]=e("span",{class:"font-bold md:hidden print:hidden"},"Unit Price: ",-1)),m(o(b(r.unit_price)),1)]),e("div",null,[t[10]||(t[10]=e("span",{class:"font-bold md:hidden print:hidden"},"Amount: ",-1)),m(o(b(r.total)),1)])]))),128))])]),e("section",Xe,[e("div",Ye,[e("div",Ze,[t[13]||(t[13]=e("span",null,"Subtotal",-1)),e("span",null,o(b(n.invoice.subtotal)),1)]),n.invoice.tax>0?(i(),l("div",et,[t[14]||(t[14]=e("span",null,"Tax",-1)),e("span",null,o(b(n.invoice.tax)),1)])):d("",!0),n.invoice.discount>0?(i(),l("div",tt,[t[15]||(t[15]=e("span",null,"Discount",-1)),e("span",null,"-"+o(b(n.invoice.discount)),1)])):d("",!0),e("div",st,[t[16]||(t[16]=e("span",null,"Total",-1)),e("span",null,o(b(n.invoice.total)),1)])])]),e("div",ot,[e("footer",nt,[n.invoice.notes?(i(),l("div",it,[t[17]||(t[17]=e("h4",{class:"mb-2 font-semibold text-gray-800"},"Notes",-1)),e("p",lt,o(n.invoice.notes),1)])):d("",!0)])])],512),e("div",at,[M(ye,{invoice:n.invoice,personalEmail:n.user.email,businessEmail:n.user.business.business_email,class:"mb-8"},null,8,["invoice","personalEmail","businessEmail"]),M(O,{onPrint:C,invoice:n.invoice},null,8,["invoice"])])]),_:1}))}},vt=q(rt,[["__scopeId","data-v-2350a2be"]]);export{vt as default};
